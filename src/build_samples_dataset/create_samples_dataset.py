import pandas as pd

SAMPLES_EXTRACTED_DATA_PATH = '../../resources/samples_extracted_data.csv'
VT_DATA_PATH = "../../resources/samples_fetched_ttps.csv"
MERGED_PATH = "../../resources/samples_dataset.csv"


def load_samples_dfs():
    extracted_data_df = pd.read_csv(SAMPLES_EXTRACTED_DATA_PATH)
    vt_data_df = pd.read_csv(VT_DATA_PATH)

    return extracted_data_df, vt_data_df


def merge_samples_dfs(vt_data_df, extracted_data_df):
    all_data_df = extracted_data_df.merge(vt_data_df, on='sha256')

    return all_data_df


if __name__ == '__main__':
    samples_vt_data, samples_extracted_data = load_samples_dfs()

    samples_df = merge_samples_dfs(samples_vt_data, samples_extracted_data)

    samples_df.to_csv(MERGED_PATH, index=False)
